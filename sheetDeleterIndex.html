<!DOCTYPE html>
<html>
<head>
  <base target="_top">

  <!-- Remember to include jQuery :) -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.0.0/jquery.min.js"></script>

  <!-- jQuery Modal -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-modal/0.9.1/jquery.modal.min.js"></script>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/jquery-modal/0.9.1/jquery.modal.min.css" />

  <!-- SWAL -->
  <script src="https://unpkg.com/sweetalert/dist/sweetalert.min.js"></script>
  <script src="//cdn.jsdelivr.net/npm/sweetalert2@11"></script>
  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>

  <!-- Required meta tags -->
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <!-- Bootstrap CSS -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
  <script src="https://kit.fontawesome.com/a5769575cc.js" crossorigin="anonymous"></script>

  <!-- Project CSS -->
  <style>
  ::-webkit-scrollbar {
    width: 7px;
    height: 6px;
  }
  ::-webkit-scrollbar-track {
    border-radius: 10px;
    background: rgba(0,0,0,0.1);
  }
  ::-webkit-scrollbar-thumb{
    border-radius: 10px;
    background: rgba(0,0,0,0.2);
  }
  ::-webkit-scrollbar-thumb:hover{
    background: rgba(0,0,0,0.25);
  }
  ::-webkit-scrollbar-thumb:active{
    background: rgba(0,0,0,0.3);
  }
  </style>


<!-- Font Awesome -->
<link
  href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css"
  rel="stylesheet"
/>
<!-- Google Fonts -->
<link
  href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700&display=swap"
  rel="stylesheet"
/>
<!-- MDB -->
<link
  href="https://cdnjs.cloudflare.com/ajax/libs/mdb-ui-kit/4.3.0/mdb.min.css"
  rel="stylesheet"
/>

  <link rel="stylesheet" href="stylesheet.html">
  <?!= HtmlService.createHtmlOutputFromFile('stylesheet').getContent(); ?>

</head>
<body style="padding: 20px 5px !important;">

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM" crossorigin="anonymous"></script>

<!-- MDB -->
<script
  type="text/javascript"
  src="https://cdnjs.cloudflare.com/ajax/libs/mdb-ui-kit/4.3.0/mdb.min.js"
></script>


    <object data="https://mocarabes.com/wp-content/uploads/2021/11/MORPH-TOOLS-LOGO.svg" width="90%" height="auto" class="morphlogo" style="padding: 0px 20px !important"> </object>
    <!--<p>En esta app tienes las funciones implementadas por el equipo I+D para Google Suite.</p>-->



<script src="https://unpkg.com/tableexport.jquery.plugin/tableExport.min.js"></script>
<script src="https://unpkg.com/bootstrap-table@1.20.2/dist/bootstrap-table-locale-all.min.js"></script>


<div><button id="delete-button" class="button-68 frozen mb-3" style="width:100%;font-weight:bold">ELIMINAR HOJAS</button></div>


<div class="container mt-2 mb-2">

<table class="table">
  <thead>
    <tr>
      <th scope="col">
        <div class="form-check">
          <input class="form-check-input" type="checkbox" value="" id="flexCheckDefault" />
        </div>
      </th>
      <th scope="col">Lorem</th>
      <th scope="col">Ipsum</th>
      <th scope="col">Dolor</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th scope="row">
        <div class="form-check">
          <input class="form-check-input" type="checkbox" value="" id="flexCheckDefault" />
        </div>
      </th>
      <td>Sit</td>
      <td>Amet</td>
      <td>Consectetur</td>
    </tr>
    <tr>
      <th scope="row">
        <div class="form-check">
          <input class="form-check-input" type="checkbox" value="" id="flexCheckDefault" />
        </div>
      </th>
      <td>Adipisicing</td>
      <td>Elit</td>
      <td>Sint</td>
    </tr>
    <tr>
      <th scope="row">
        <div class="form-check">
          <input class="form-check-input" type="checkbox" value="" id="flexCheckDefault"/>
        </div>
      </th>
      <td>Hic</td>
      <td>Fugiat</td>
      <td>Temporibus</td>
    </tr>
  </tbody>
</table>

</div>









  <script>
    const WorksheetDeleteApp = {}

    WorksheetDeleteApp.afterSidebarLoads = function (){
      WorksheetDeleteApp.worksheetsTable1 = Metro.getPlugin("#worksheetsTable", "table")
      WorksheetDeleteApp.loadWorksheetNames()
    } // afterSidebarLoads

    WorksheetDeleteApp.loadWorksheetNames = function(){

      google.script.run.withSuccessHandler(sheetNames => {
        WorksheetDeleteApp.worksheetsTable1.setItems(sheetNames)
        WorksheetDeleteApp.worksheetsTable1.reload()
      }).getWorksheetNames()

    }

    WorksheetDeleteApp.deleteSheets = function(){
      var sheetNamesToDelete = WorksheetDeleteApp.worksheetsTable1.getSelectedItems().map(r => r[0]);
      var sheetNamesToDeleteAsString = JSON.stringify(sheetNamesToDelete);

      google.script.run.withSuccessHandler(e => {swalsuccess(), WorksheetDeleteApp.loadWorksheetNames()}).withFailureHandler(swalerror).deleteWorksheets(sheetNamesToDeleteAsString)


    }


    WorksheetDeleteApp.openDialogActions = function(){
      var selectedWorksheetCount = WorksheetDeleteApp.worksheetsTable1.getSelectedItems().lenght
      console.log(selectedWorksheetCount)
      var worksheetCount = WorksheetDeleteApp.worksheetsTable1.getItems().lenght

            Swal.fire({
            title: 'Borrar hojas',
            text: `Vas a eliminar (${selectedWorksheetCount}) hojas. Confirma para continuar.`,
            icon: 'info',
            allowOutsideClick: false,
            //preConfirm: Swal.deleteEmptyRows(),
            showLoaderOnConfirm: true,
            showDenyButton: false,
            showCancelButton: true,
            cancelButtonText: `Cancelar`,
            confirmButtonText: `Continuar`,
            confirmButtonColor: '#0D6EFD',
            }).then((result) => {
            if (result.isConfirmed) {

            WorksheetDeleteApp.deleteSheets()


            } else if (result.isDenied) {
              return;
            }
            });

      if(selectedWorksheetCount === worksheetCount){


      }else{

      }

    }

    document.addEventListener("DOMContentLoaded",WorksheetDeleteApp.afterSidebarLoads)
    document.getElementById("delete-button").addEventListener("click", WorksheetDeleteApp.openDialogActions)

  </script>







  <script>
    function swalsuccess(e) {
      Swal.fire({
        title: '¡Listo!',
        text: 'Se han eliminado las hojas seleccionadas.',
        icon: 'success',
        confirmButtonColor: '#0D6EFD',
        confirmButtonText: 'Continuar'
      });
    }
  </script>

  <script>
    function swalsuccess2(e) {
      Swal.fire({
        title: '¡Listo!',
        text: 'El cuadro de superficies se ha actualizado.',
        icon: 'success',
        confirmButtonColor: '#0D6EFD',
        confirmButtonText: 'Continuar'
      });
    }
  </script>

  <script>
    function swalerror(e) {
      Swal.fire({
        title: 'Error!',
        text: 'La función no ha podido ejecutarse.',
        icon: 'error',
        confirmButtonColor: '#0D6EFD',
        confirmButtonText: 'Entendido'
      });
    }
  </script>

  <script>
    function swalinfo(e) {
      Swal.fire({
        title: 'Atención',
        text: 'Esta función aún está en desarrollo...',
        icon: 'info',
        confirmButtonColor: '#0D6EFD',
        confirmButtonText: 'Continuar'
      });
    }
  </script>

  <script>
    function swaload() {
      Swal.fire({
        template: '#swaloadTemplate',
        padding: '1.2em 0em 2em 0em',
        showConfirmButton: false,
        allowOutsideClick: false,
      }).then((result) => {
      if (result.isConfirmed) {
        return true;
      } else if (result.isDenied) {
        return false;
      }
      })
    }
  </script>

<template id="swaloadTemplate">
  <swal-title><div class="swal-tt" ><span class="loading">Ejecutando<span></div></swal-title>
  <swal-html><div class="swal-tt">Por favor, no modifiques ni cierres el documento.</div></swal-html>
  <swal-html><div class="swal2-watermark">MORPH I+D</div></swal-html>

  <swal-image src="https://raw.githubusercontent.com/Codelessly/FlutterLoadingGIFs/master/packages/cupertino_activity_indicator_selective.gif" width="35%" height="auto" />
  <swal-param name="allowEscapeKey" value="false" />
  <swal-param
    name="customClass"
    value='{ "popup": "my-popup" }' />
</template>

<style>
    .loading::after {
      display: inline-block;
      animation: dotty steps(1,end) 2s infinite;
      content: '';
      text-align:left !important;
    }

    @keyframes dotty {
        0%   { content: ''; }
        25%  { content: '.'; }
        50%  { content: '..'; }
        75%  { content: '...'; }
        100% { content: ''; }
    }
</style>



<script src="https://unpkg.com/bootstrap-table@1.20.2/dist/bootstrap-table.min.js"></script>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.0-beta1/dist/js/bootstrap.bundle.min.js" integrity="sha384-pprn3073KE6tl6bjs2QrFaJGz5/SUsLqktiwsUTF55Jfv3qYSDhgCecCxMW52nD2" crossorigin="anonymous"></script>



</body>
</html>
