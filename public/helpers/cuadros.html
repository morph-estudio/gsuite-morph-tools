<div class="mb-4 text-center">
  <img src='https://cdn-icons-png.flaticon.com/512/2457/2457902.png' height='auto' width='75' class="mx-auto" style="margin-bottom:15px" />
  <h3 class="montserrat">Manejo de cuadros</h3>
</div>

<div class="card mt-2 mb-1">
  <div class="card-header font-weight-bold" style="font-weight:bold">
    Cuadro de superficies y mediciones
  </div>
  <div class="card-body">

    <div class="mb-3">

      <div class="form-check form-switch">
        <input class="form-check-input shadow-none" type="checkbox" role="switch" id="update-linkpage">
        <label class="form-check-label" style="position:relative;top:1px" for="update-linkpage">Actualizar hoja LINK </label>
        <span data-bs-toggle="tooltip" data-bs-placement="right" title="Marcar esta casilla en la primera actualización del cuadro o cuando haya nuevos archivos .txt de exportación. Se buscarán de nuevo los archivos y carpetas y se formateará la hoja LINK">
        <i class="fa-regular fa-circle-question fa-questionstyle" style="position: relative; top:1px"></i>
        </span>
      </div>

      <div class="mt-2 updateLinkPageCollapse collapse">

        <div style="margin-left: 20px; margin-bottom: 20px;">
          <div class="form-check">
            <input class="form-check-input shadow-none" type="checkbox" value="" id="update-maindata" checked>
            <label class="form-check-label" for="update-maindata">
              Datos principales
            </label>
          </div>
          <div class="form-check">
            <input class="form-check-input shadow-none" type="checkbox" value="" id="update-ai" checked>
            <label class="form-check-label" for="update-ai">
              Archivos importados
            </label>
          </div>
          <div class="form-check">
            <input class="form-check-input shadow-none" type="checkbox" value="" id="update-ac" disabled>
            <label class="form-check-label" for="update-ac" title="Esta opción aún no está disponible...">
              Archivos conectados
            </label>
          </div>
        </div>

        <div class="input-group flex-nowrap update rounded-pill mb-2">
          <span class="input-group-text prefixUpdateClassColor">Prefijo<span data-bs-toggle="tooltip" data-bs-placement="right" title="Por defecto se importarán los archivos con prefijo TXT (por ejemplo, TXT Sheets Ventanas), pero si usas un paquete de archivos con otro identificativo escribe aquí el prefijo"><i class="fa-regular fa-circle-question fa-questionstyle" style="color:#c0cbd1"></i></span></span> 
          <input type="text" class="form-control shadow-none prefixUpdateClass" id="updatePrefixID" placeholder="TXT">
        </div>

        <div class="form-check form-switch">
          <input class="form-check-input shadow-none prefixUpdateClass" type="checkbox" role="switch" id="prefix-all-switch" onclick="document.getElementById('updatePrefixID').disabled = this.checked">
          <label class="form-check-label" style="position:relative;top:1px" for="prefix-all-switch">Ignorar prefijos</label> <span data-bs-toggle="tooltip" data-bs-placement="right" title="Añade todos los archivos de la carpeta 'ExpTXT' sin importar el prefijo.">
          <i class="fa-regular fa-circle-question fa-questionstyle" style="position: relative; top:2px"></i>
        </div>

        <div class="form-check form-switch">
          <input class="form-check-input shadow-none prefixUpdateClass" type="checkbox" role="switch" id="update-keepVisibility">
          <label class="form-check-label" style="position:relative;top:1px" for="update-keepVisibility">Mantener visibilidad</label>
          <span data-bs-toggle="tooltip" data-bs-placement="right" title="Por defecto las hojas importadas se ocultan, marca esta opción para mantenerlas visibles">
          <i class="fa-regular fa-circle-question fa-questionstyle" style="position: relative; top:2px"></i>
        </div>

      </div>

      <div class="form-check form-switch">
        <input class="form-check-input shadow-none" type="checkbox" role="switch" id="update-historico">
        <label class="form-check-label" style="position:relative;top:1px" for="update-historico">Crear punto en histórico de superficies
        <span data-bs-toggle="tooltip" data-bs-placement="right" title="Todos los cuadros de superficies cuentan con una hoja HISTÓRICO Construidas donde registrar los cambios en el desarrollo del proyecto">
        <i class="fa-regular fa-circle-question fa-questionstyle" style="position: relative; top:2px"></i></label>
      </div>

      <div id="devmenuhidden" style="display: none;" class="devAreaPermission">
        <div class="form-check form-switch mt-2">
          <input class="form-check-input shadow-none" type="checkbox" role="switch" id="update-debugReport">
          <label class="form-check-label" style="position:relative;top:1px" for="update-debugReport">Debug Report</label>
          <span data-bs-toggle="tooltip" data-bs-placement="right" title="Opción para desarrolladores: incluye datos adicionales al logger que pueden ayudar a resolver problemas">
          <i class="fa-regular fa-circle-question fa-questionstyle" style="position: relative; top:2px"></i>
        </div>
      </div>

    </div>

    <div>
      <button id="csUpdater" class="btn btn-primary gmt sup yellow w-100 shadow-none mt-1 mb-1 centerScroll" style="font-size:20px">Actualizar</button>
      <button id="csFreezer" class="btn btn-primary gmt inf blue w-100 shadow-none centerScroll" style="font-size:20px" onclick="swalConfirm('morphFreezer', 'El archivo se ha congelado correctamente.', 'Una vez ejecutado no se puede detener. Confirma para continuar.', this.id)">Congelar</button>
    </div>

  </div>
</div>

<div class="card mt-2 mb-1">
  <div class="card-header font-weight-bold" style="font-weight:bold">
    Otras funciones
  </div>
  <div class="card-body p-0">

    <button class="btn btn-primary index i2 shadow-none w-100 centerScroll dashed" onclick="swalConfirm('refreshNamedRanges', 'Los rangos se han actualizado correctamente.', 'Se actualizarán los rangos nombrados. Por favor, no continúes si no sabes lo que estás haciendo...')"><i class="fa-solid fa-registered fa-margin fa-fw"></i>Actualizar rangos nombrados</button>
    <button class="btn btn-primary index i2 shadow-none w-100 centerScroll" onclick="swalConfirm('deleteNamedRanges', 'Se han borrado todos los rangos nombrados.', 'Cuidado, podrían perderse referencias de celda. Por favor, no continúes si no sabes lo que estás haciendo...')"><i class="fa-solid fa-eraser fa-margin fa-fw"></i>Eliminar rangos nombrados</button>
    <button class="btn btn-primary index i2 shadow-none w-100 centerScroll ult2" onclick="swalConfirm('historicoDeSuperficies', 'El punto histórico se ha añadido correctamente.', 'Se creará un punto temporal en el histórico de superficies. Confirma para continuar.')"><i class="fa-solid fa-clock-rotate-left fa-margin fa-fw"></i>Crear punto manual en el histórico de superficies</button>

    <!--
    <button class="btn btn-primary index i2  shadow-none w-100 centerScroll" onclick="execNoSuccess('getConectedSheetList', 0, 6, 'LINK')"><i class="fa-solid fa-network-wired fa-margin fa-fw"></i>Generar lista de archivos conectados</button>
    <button class="btn btn-primary index i2 shadow-none w-100 centerScroll" onclick="execNoSuccess('getConectedSheetList', 0, 0)"><i class="fa-solid fa-network-wired fa-margin fa-fw"></i>Generar lista de archivos conectados en hoja vacía</button>
    -->

  </div>
</div>

<div id="devmenuhidden" style="display: none;" class="devAreaPermission">
  <div class="card mt-2 mb-1">
    <div class="card-header font-weight-bold" style="font-weight:bold">
      Spreadsheet System<span data-bs-toggle="tooltip" data-bs-placement="right" title="Morph Spreadsheet System es un sistema que realiza funciones de Google Sheets en diferido, evitando la actualización de fórmulas a tiempo real">
      <i class="fa-regular fa-circle-question fa-questionstyle" style=""></i></span>
    </div>
    <div class="card-body p-3">

  <div class="input-group flex-nowrap update rounded-pill mt-2 mb-1" style="">
    <span class="input-group-text" style="">Referencia<span data-bs-toggle="tooltip" data-bs-placement="right" title="Escribe la letra de la columna que se usará como referencia. Se actualizará el documento a partir de la última celda con datos de esa columna">
      <i class="fa-regular fa-circle-question fa-questionstyle" style=""></i></span></span> 
    <input type="text" class="form-control shadow-none" id="mssUpdateColRef" onclick="stopPropagation()" style="" placeholder="ej: C">
  </div>

        <button class="btn btn-purple gmt btn-xl w-100 shadow-none centerScroll" style="" id="mssUpdate">Actualizar base de datos
          
        </button>

        <div class="form-check form-switch d-flex align-items-center mt-3">
          <div><input class="form-check-input robotoSwitch shadow-none" type="checkbox" role="switch" id="mssUpdateAll"></div>
          <label class="form-check-label robotoLabel" for="mssUpdateAll">Actualizar todo<span data-bs-toggle="tooltip" data-bs-placement="right" title="Actualizar todas las filas usando Spreadsheet System">
          <i class="fa-regular fa-circle-question fa-questionstyle roboto"></i></span></label>
        </div>

    </div>
  </div>
</div>

<div id="borrarFilasExcesivas" style="margin-top:40px">

  <div class="mb-4 text-center">
    <img src='https://cdn-icons-png.flaticon.com/512/4110/4110253.png' height='auto' width='75' class="mx-auto" style="margin-bottom:15px" />
    <h3 class="montserrat">Optimizar documento</h3>
  </div>

<!--
  <div class="card">
    <div class="card-header" style="font-weight:bold">
      Eliminar filas innecesarias<span data-bs-toggle="tooltip" data-bs-placement="right" title="Elimina las filas sobrantes de la hoja actual hasta llegar a la fila que establezcas como fila máxima">
  <i class="fa-regular fa-circle-question fa-questionstyle" style=""></i></span>
    </div>
    <div class="card-body">
      <div class="input-group flex-nowrap update rounded-pill">
        <span class="input-group-text prefixUpdateClassColor">Fila máxima<span data-bs-toggle="tooltip" data-bs-placement="right" title="Escribe el número de fila máxima que quieres en la hoja actual"><i class="fa-regular fa-circle-question fa-questionstyle" style="color:#c0cbd1"></i></span></span> 
        <input type="text" class="form-control shadow-none" id="rowsDeleteInput" placeholder="ej: 100">
      </div>
      <button class="btn btn-primary btn-lg-gmt w-100 shadow-none centerScroll mt-1" id="rowsDeleteButton">Borrar filas</button>
    </div>
  </div>
-->

  <div class="card mt-2 mb-1">
    <div class="card-header" style="font-weight:bold">
      Optimización automática<span data-bs-toggle="tooltip" data-bs-placement="right" title="Elimina las filas sobrantes de TODAS LAS HOJAS del documento hasta llegar a la fila máxima 1500/3000/6000, según el botón que elijas">
  <i class="fa-regular fa-circle-question fa-questionstyle" style=""></i></span>
    </div>
    <div class="card-body">

      <div class="d-flex">
        <button class="btn btn-outline optGreen btn-lg-gmt w-50 shadow-none optSpr" id="optSpr1500">+1500</button>
        <button class="btn btn-outline optYellow btn-lg-gmt w-50 shadow-none ms-1 optSpr" id="optSpr3000">+3000</button>
        <button class="btn btn-outline optRed btn-lg-gmt w-50 shadow-none ms-1 optSpr" id="optSpr6000">+6000</button>
      </div>

      <div class="container mt-3">
        <div class="row">
          <div class="col text-center">
            <button type="button" class="cache-btn centerScroll" data-toggle="tooltip" data-placement="bottom" title="Borrar caché del documento" onclick="swalConfirm('purgeDocumentCache', 'La caché se ha purgado correctamente.', 'Se borrará la memoria caché del documento. Confirma antes de continuar.')">
              <img src="https://cdn-icons-png.flaticon.com/512/4459/4459985.png" alt="Icono de borrar caché">
            </button>
            
          </div>
        </div>
      </div>

    </div>
  </div>

</div>

<div id="formulaInterop" style="display: none; margin-top:40px" class="formulaModPermission">

  <div class="mb-4 text-center">
    <img src='https://cdn-icons-png.flaticon.com/512/3190/3190768.png' height='auto' width='75' class="mx-auto" style="margin-bottom:15px" />
    <h3 class="montserrat">Gestión de fórmulas</h3>
  </div>

  <div class="card">
    <div class="card-header" style="font-weight:bold">
      Morph Formula Database<span data-bs-toggle="tooltip" data-bs-placement="right" title="Importa todas las fórmulas de la base de datos asociadas a este archivo">
  <i class="fa-regular fa-circle-question fa-questionstyle" style=""></i></span>
    </div>
    <div class="card-body">

      <div class="form-check form-switch d-flex align-items-center mb-1">
        <div><input class="form-check-input robotoSwitch shadow-none" type="checkbox" role="switch" id="formulaInteropAllDocument"></div>
        <label class="form-check-label robotoLabel" for="formulaInteropAllDocument">Aplicar a toda la hoja de cálculo<span data-bs-toggle="tooltip" data-bs-placement="right" title="Por defecto se importa/exporta la hoja actual, pero puedes marcar esta casilla para aplicarlo a todo el documento">
        <i class="fa-regular fa-circle-question fa-questionstyle roboto"></i></span></label>
      </div>

      <div class="form-check form-switch d-flex align-items-center">
        <div><input class="form-check-input robotoSwitch shadow-none" type="checkbox" role="switch" id="formulaInteropFormat"></div>
        <label class="form-check-label robotoLabel" for="formulaInteropFormat">Formatear fórmulas al importar/exportar<span data-bs-toggle="tooltip" data-bs-placement="right" title="Reorganiza las fórmulas en el archivo de modo que sean más sencillas de leer.">
        <i class="fa-regular fa-circle-question fa-questionstyle roboto"></i></span></label>
      </div>


      <select class="form-select shadow-none mb-2 mt-3" id="formulaInteropSelectFileType">
        <option value="plantilla" selected>Documento de plantilla o relacionados</option>
        <option value="proyecto">El documento tiene código de proyecto</option>
        <option value="otros">Es otro tipo de documento</option>
      </select>

      <button id="formulaImportButton" class="btn btn-primary gmt sup coral w-100 shadow-none mb-1 centerScroll">Importar fórmulas de la base de datos</button>
      <button id="formulaExportButton" class="btn btn-primary gmt inf steel w-100 shadow-none centerScroll">Exportar fórmulas a la base de datos</button>

    </div>
  </div>

  <div class="card mt-2 mb-1">
    <div class="card-header font-weight-bold" style="font-weight:bold">
      Registro local de fórmula<span data-bs-toggle="tooltip" data-bs-placement="right" title="Registra el cambio de la fórmula seleccionada en el Panel de Control de proyecto">
      <i class="fa-regular fa-circle-question fa-questionstyle" style=""></i></span>
    </div>
    <div class="card-body">

      <div class="form-check form-switch mb-3 d-flex align-items-center">
        <div><input class="form-check-input robotoSwitch shadow-none" type="checkbox" role="switch" id="sendFormulaToTemplate"></div>
        <label class="form-check-label robotoLabel" for="sendFormulaToTemplate">Revisar en plantilla<span data-bs-toggle="tooltip" data-bs-placement="right" title="Marca esta casilla para que un administrador evalúe si el cambio debe integrarse en la plantilla o nave nodriza">
        <i class="fa-regular fa-circle-question fa-questionstyle roboto"></i></span></label>
      </div>
      
      <div class="form-group">
        <div class="input-group mb-1">
          <textarea class="form-control shadow-none me-1" id="formulaLogFormulaText" rows="2" placeholder="Copia o inyecta aquí la fórmula antigua." data-placeholder="placeholderFormula"></textarea>
          <button type="button" id="formulaDropperButton" class="btn shadow-none btn-formula-dropper centerScroll" style="width:16%; display: flex; justify-content: center; align-items: center;">
            <i class="fa-solid fa-eye-dropper"></i>
          </button>
        </div>

      <button class="btn btn-primary w-100 shadow-none centerScroll" id="formulaLogButton">Registrar nueva fórmula</button>
      </div>

    </div>
  </div>

</div>
