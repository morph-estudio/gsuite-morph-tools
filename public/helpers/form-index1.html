<form novalidate>

  <div id="userform3">
    <div class="mb-2">

      <label for="list-files" class="form-label"><i class="fa-regular fa-folder fa-h-margin"></i>LINK/ID de la carpeta</label>
      <input type="text" class="form-control" id="list-files" placeholder="ej: https://drive.google.com/drive/folders/1DHirb56iLf-T_n6Idq2MP8f8Ok765JuZ?usp=sharing" aria-describedby="template-id-2-help" required>
      <div class="invalid-feedback">
      Introduce una ID correcta.
      </div>
      <div id="template-id-2-help" class="form-text mt-2">Esta herramienta eliminar√° el contenido de la hoja activa para crear la lista.</div>

      <div class="form-check form-switch mt-3">
        <input class="form-check-input" type="checkbox" onchange="document.getElementById('list-files').disabled = this.checked" role="switch" id="use-a1" >
        <label class="form-check-label" for="use-a1">Usar celda A1</label>
      </div>

        <button class="btn btn-primary btn-lg mt-3" id="listButton">Listar archivos</button>

    </div>
  </div>
</form>

<script>

  function afterButtonClicked(){
  
    if(validate()){
  
      var listFolderID = document.getElementById("list-files");
      var useA1 = document.getElementById("use-a1");
      var useA1Value = useA1.checked;
      var rowData = {
        listFolderID: listFolderID.value,
        useA1: useA1Value,
      };
  
        swaload();
        google.script.run.withSuccessHandler(e => {swalsuccess(e), afterSubmit(e)}).withFailureHandler(swalerror).linksArchivos(rowData);
  
    } else{
      //$("#errorNotification").toast("show");
    }
  }
  
  function afterSubmit(e){
    clearFields(["list-files"]);
    //$("#successNotification").toast("show");
  }
  
  function clearFields(feilds){
    feilds.forEach(function(feild){
      var el = document.getElementById(feild);
      el.value = "";
    });
  }
  
  function validate(){
    var fieldsToValidate = document.querySelectorAll("#userform3 input");
  
    //is-invalid
  
    Array.prototype.forEach.call(fieldsToValidate, function(el){
      if (el.checkValidity()){
        el.classList.remove("is-invalid");
      } else{
        el.classList.add("is-invalid");
      }
    });
  
    return Array.prototype.every.call(fieldsToValidate,function(el){
    return el.checkValidity();
    });
  
  }
  
  document.getElementById("listButton").addEventListener("click",afterButtonClicked);
  
  </script>